<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css" />
    <!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/showdown/dist/showdown.min.js"></script>
    <script>
        fetch("posts.json")
            .then(response => response.json())
            .then(data => {
                // Loop through the posts and create links and sections for each one
                for (let post of data.posts) {
                    // Create a link element
                    // let li = document.createElement("li");
                    let link = document.createElement("a");
                    link.href = "#" + post.id;
                    link.textContent = post.title;
                    // Append the link to the navigation div
                    // li.appendChild(link);
                    document.getElementById("toc").appendChild(link);


                    //create rowdiv element
                    let rowDiv = document.createElement("div");
                    rowDiv.className = "row";
                    document.getElementById("posts").appendChild(rowDiv);
                    //create colDiv element
                    let colDiv = document.createElement("div");
                    colDiv.className = "col-md-10";
                    rowDiv.appendChild(colDiv)
                    // Create a section element
                    let section = document.createElement("section");
                    section.id = post.id;
                    // Create a title element
                    let title = document.createElement("h1");
                    title.textContent = post.title;
                    // Append the title to the section
                    section.appendChild(title);
                    // Create a content element
                    let content = document.createElement("div");
                    content.className = "content";
                    // Append the content to the section
                    section.appendChild(content);
                    // Append the section to the main div
                    colDiv.appendChild(section);
                }
                // Load the markdown files and render them using Showdown
                let converter = new showdown.Converter();
                let sections = document.querySelectorAll("section");
                for (let section of sections) {
                    let id = section.id;
                    let contentDiv = section.querySelector(".content");
                    fetch("./_posts/" + id + ".md")
                        .then(response => response.text())
                        .then(text => {
                            let html = converter.makeHtml(text);
                            contentDiv.innerHTML = html;
                        });
                }
            });
    </script>
    <style>
        body {
            margin-top: 42px;
            text-align: left;
            background-color: black;
            color: beige;
        }

        h1 {
            text-align: center;
        }

        nav[data-toggle="toc"] {
            top: 42px;
        }

        /* small screens */
        @media (max-width: 768px) {

            /* override stickyness so that the navigation does not follow scrolling */
            nav[data-toggle="toc"] {
                margin-bottom: 42px;
                position: static;
            }

            /* PICK ONE */
            /* don't expand nested items, which pushes down the rest of the page when navigating */
            nav[data-toggle="toc"] .nav .active .nav {
                display: none;
            }
        }
    </style>
</head>

<body data-spy="scroll" data-target="#toc">
    <div class="container">
        <div class="row">
            <div class="col-sm-9">
                <div class="container" id="posts">
                </div>
            </div>
            <div class="col-sm-3">
                <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
            </div>
        </div>
    </div>
</body>

</html>